# –î–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ GPT-2 –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ–ø–∏—Å–∞–Ω–∏–π –∑–∞–≤–µ–¥–µ–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ —Ç–∏–ø–∞ –∏ –æ—Ü–µ–Ω–∫–∏

<p align="center">
  <img src="./preview.png" alt="–°–∏–º—É–ª—è—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞" width="900">
</p>

## –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è

–í –¥–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –ø—Ä–æ—Ü–µ—Å—Å –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã GPT-2. –¶–µ–ª—å—é —Ä–∞–±–æ—Ç—ã —è–≤–ª—è–µ—Ç—Å—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –¥–æ–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–æ–≤, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è–º, –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –æ—Ü–µ–Ω–∫–µ. –ò—Å–ø–æ–ª—å–∑—É—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤–∫–ª—é—á–∞–ª –Ω–∞–∑–≤–∞–Ω–∏—è –∑–∞–≤–µ–¥–µ–Ω–∏–π, –∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏, –º—ã –æ–±—É—á–∏–ª–∏ –º–æ–¥–µ–ª—å –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥–ª–∏ –±—ã –æ—Ç—Ä–∞–∂–∞—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä –∏ —É—Ä–æ–≤–µ–Ω—å –∑–∞–≤–µ–¥–µ–Ω–∏–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∏—Ö –æ—Ü–µ–Ω–æ—á–Ω–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏.

–í —Ö–æ–¥–µ —Ä–∞–±–æ—Ç—ã –æ—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –±—ã–ª–æ —É–¥–µ–ª–µ–Ω–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, top_k –∏ top_p, –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø—Ä–æ–≤–æ–¥–∏–ª–æ—Å—å –Ω–∞ –º–æ—â–Ω–æ–π –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã Tesla A-100 –∏ QUDA, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏–ª–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è –¥–æ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ 20 –º–∏–Ω—É—Ç.

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∫–∞–∑–∞–ª–∏, —á—Ç–æ –¥–æ–æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å —Å–ø–æ—Å–æ–±–Ω–∞ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –∑–∞–¥–∞–Ω–Ω—ã–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º, —Ö–æ—Ç—è –∏–Ω–æ–≥–¥–∞ –∏ –≤—ã—è–≤–ª—è–ª–∏—Å—å —Å–ª—É—á–∞–∏ –ø–æ—Ç–µ—Ä–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏–ª–∏ —Å—Ç—Ä–∞–Ω–Ω–æ—Å—Ç–∏ –≤ —Ç–µ–∫—Å—Ç–∞—Ö.

## –í–≤–µ–¥–µ–Ω–∏–µ

–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç (–ò–ò) ‚Äî —ç—Ç–æ –æ–±–ª–∞—Å—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö –Ω–∞—É–∫, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞–Ω–∏–µ–º —Å–∏—Å—Ç–µ–º, —Å–ø–æ—Å–æ–±–Ω—ã—Ö –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–¥–∞—á–∏, —Ç—Ä–µ–±—É—é—â–∏–µ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞. –≠—Ç–∏ –∑–∞–¥–∞—á–∏ –≤–∫–ª—é—á–∞—é—Ç –≤ —Å–µ–±—è –æ–±—É—á–µ–Ω–∏–µ (–ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –ø—Ä–∞–≤–∏–ª –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏), —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–µ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω—ã—Ö –∏–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –≤—ã–≤–æ–¥–æ–≤) –∏ —Å–∞–º–æ–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫—É. –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —è–∑—ã–∫–∞, –ò–ò –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ –ø–µ—Ä–µ–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ —Å –æ–¥–Ω–æ–≥–æ —è–∑—ã–∫–∞ –Ω–∞ –¥—Ä—É–≥–æ–π, —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏, –∞–Ω–∞–ª–∏–∑ —Å–µ–Ω—Ç–∏–º–µ–Ω—Ç–æ–≤, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ç–µ–∫—Å—Ç–∞ –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ.

–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –≤ –∞–Ω–∞–ª–∏–∑–µ —Ç–µ–∫—Å—Ç–∞, –∏–∑–≤–µ—Å—Ç–Ω–æ–µ —Ç–∞–∫–∂–µ –∫–∞–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞ (NLP), –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–∞—à–∏–Ω–∞–º –ø–æ–Ω–∏–º–∞—Ç—å, –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–π —è–∑—ã–∫ –≤ –ø–æ–ª–µ–∑–Ω–æ–π —Ñ–æ—Ä–º–µ. –° –ø–æ–º–æ—â—å—é –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –∏ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, —Å–∏—Å—Ç–µ–º—ã –ò–ò –º–æ–≥—É—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –±–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π –∏ –∏–Ω—Å–∞–π—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–∫—Ä—ã—Ç—ã –æ—Ç —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ –≥–ª–∞–∑–∞. –≠—Ç–æ –∏–º–µ–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é —á–∞—Ç-–±–æ—Ç–æ–≤ –¥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ —É—Å–ª—É–≥ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –æ—Ç–∑—ã–≤–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

–ù–∞ –ø—Ä–∏–º–µ—Ä–µ —Ä–∞–±–æ—Ç—ã –ø–æ –¥–æ–æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–∏ GPT-2 –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–∑—ã–≤–æ–≤ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –º—ã –º–æ–∂–µ–º —É–≤–∏–¥–µ—Ç—å, –∫–∞–∫ –ø–µ—Ä–µ–¥–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –ò–ò –º–æ–≥—É—Ç –±—ã—Ç—å –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–Ω–∞—á–∏–º—ã—Ö –∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –≤—ã–≤–æ–¥–æ–≤, —É—á–∏—Ç—ã–≤–∞—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.

## –¶–µ–ª—å

–¶–µ–ª—å—é –¥–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã —è–≤–ª—è–µ—Ç—Å—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–æ–æ–±—É—á–µ–Ω–∏—è –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ GPT-2 –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –í —ç—Ç–æ–π —Ä–∞–±–æ—Ç–µ –ø–æ–∫–∞–∑–∞–Ω –æ–¥–∏–Ω –∏–∑ –ø—Ä–∏–º–µ—Ä–æ–≤, –∫–∞–∫ —Å –ø–æ–º–æ—â—å—é –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å —è–∑—ã–∫–æ–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–µ ‚Äî —Å–æ–∑–¥–∞–Ω–∏—é –æ—Ç–∑—ã–≤–æ–≤ –æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏—è—Ö. –≠—Ç–∞ –∑–∞–¥–∞—á–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –∞–Ω–∞–ª–∏–∑ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç—Ä—ë—Ö –∫–ª—é—á–µ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: –Ω–∞–∑–≤–∞–Ω–∏—è –∑–∞–≤–µ–¥–µ–Ω–∏—è, –µ–≥–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –æ—Ü–µ–Ω–∫–∏, –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ –ø—Ä—è–º–æ–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –≤ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–∞—Ö –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å—Å—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º, —Ü–µ–Ω–Ω–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏. –¢–∞–∫–æ–µ –¥–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–π, –∂–µ–ª–∞—é—â–∏—Ö —É–≥–ª—É–±–∏—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –≥–ª—É–±–æ–∫–∏—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∑–∞–¥–∞—á.

–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –ø—Ä–æ–µ–∫—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Å–≤–µ—Ç–∏—Ç—å –≤–∞–∂–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã —Ä–∞–±–æ—Ç—ã —Å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º, —Ç–∞–∫–∏–µ –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–æ–æ–±—É—á–µ–Ω–∏—è –∏ –æ—Ü–µ–Ω–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ –Ω–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö. –ü–æ–¥–æ–±–Ω—ã–π –æ–ø—ã—Ç –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è –≤—Å–µ—Ö, –∫—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç—Å—è –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∑–Ω–∞–Ω–∏—è –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–±–ª–∞—Å—Ç—è—Ö, –æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –¥–æ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤.

## [–ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥](https://github.com/AntonSHBK/fine_tune_gpt_model)

## –û–ø–∏—Å–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞

–í –∫–∞—á–µ—Å—Ç–≤–µ –¥–∞—Ç–∞—Å–µ—Ç–∞ –≤ –¥–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ –±—ã–ª–æ –ø—Ä–∏–Ω—è—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [Geo Reviews Dataset 2023](https://huggingface.co/datasets/d0rj/geo-reviews-dataset-2023?row=1), –¥–æ—Å—Ç—É–ø–Ω—ã–π –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ –Ø–Ω–¥–µ–∫—Å –ö–∞—Ä—Ç. –≠—Ç–æ—Ç –¥–∞—Ç–∞—Å–µ—Ç –≤–∫–ª—é—á–∞–µ—Ç 500,000 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤ –æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è—Ö –≤ –†–æ—Å—Å–∏–∏, —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –≤ –ø–µ—Ä–∏–æ–¥ —Å —è–Ω–≤–∞—Ä—è –ø–æ –∏—é–ª—å 2023 –≥–æ–¥–∞. –û—Ç–ª–∏—á–∏—Ç–µ–ª—å–Ω–æ–π —á–µ—Ä—Ç–æ–π –¥–∞–Ω–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —è–≤–ª—è–µ—Ç—Å—è –µ–≥–æ –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ: –≤—Å–µ —Ç–µ–∫—Å—Ç—ã –æ—á–∏—â–µ–Ω—ã –æ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∫–æ—Ä–æ—Ç–∫–∏—Ö –æ–¥–Ω–æ—Å–ª–æ–∂–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤.

–î–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ —É–¥–æ–±—Å—Ç–≤–∞ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ, –¥–∞—Ç–∞—Å–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤ —Ñ–æ—Ä–º–∞—Ç–µ tskv. –ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–ª—è:
- **–ê–¥—Ä–µ—Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ (`address`)**: –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π –æ—Ç–∑—ã–≤–æ–≤.
- **–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ (`name_ru`)**: –ù–∞–∑–≤–∞–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ, –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–∞–≤–µ–¥–µ–Ω–∏—è.
- **–°–ø–∏—Å–æ–∫ —Ä—É–±—Ä–∏–∫, –∫ –∫–æ—Ç–æ—Ä—ã–º –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è (`rubrics`)**: –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π –ø–æ–º–æ–≥–∞–µ—Ç –º–æ–¥–µ–ª–∏ –ª—É—á—à–µ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã—Ö –æ—Ç–∑—ã–≤–æ–≤.
- **–û—Ü–µ–Ω–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç 0 –¥–æ 5 (`rating`)**: –û—Ç—Ä–∞–∂–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —á—Ç–æ –Ω–∞–ø—Ä—è–º—É—é –≤–ª–∏—è–µ—Ç –Ω–∞ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∏ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.
- **–¢–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞ (`text`)**: –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–∑—ã–≤, –∫–æ—Ç–æ—Ä—ã–π —Å–ª—É–∂–∏—Ç –æ–±—É—á–∞—é—â–∏–º –º–∞—Ç–µ—Ä–∏–∞–ª–æ–º –¥–ª—è –º–æ–¥–µ–ª–∏, –ø–æ–∑–≤–æ–ª—è—è –µ–π –∏–∑—É—á–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ç–∏–ª–∏ –∏ —Ñ–æ—Ä–º—ã –≤—ã—Ä–∞–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –º–Ω–µ–Ω–∏–π.

–í—ã–±–æ—Ä –¥–∞–Ω–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞ –±—ã–ª –æ–±—É—Å–ª–æ–≤–ª–µ–Ω –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å—é –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –æ–±—ä–µ–º–æ–º —Ç–µ–∫—Å—Ç–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –¥–æ–æ–±—É—á–µ–Ω–∏—è. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–∞–∫–æ–≥–æ –æ–±—à–∏—Ä–Ω–æ–≥–æ –∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ—Å—Ç–∏—á—å –≤—ã—Å–æ–∫–æ–π —Å—Ç–µ–ø–µ–Ω–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤, –¥–µ–ª–∞—è –∏—Ö –ø–æ–ª–µ–∑–Ω—ã–º–∏ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö, –≤–∫–ª—é—á–∞—è —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç–∑—ã–≤–æ–≤ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–ø—É—Ç–∞—Ü–∏–µ–π.

–í –¥–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö ‚Äî –≤—Å–µ–≥–æ 15,000 —Å—Ç—Ä–æ–∫ –∏–∑ –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞. –≠—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –±—ã–ª–æ –ø—Ä–∏–Ω—è—Ç–æ —Å —Ü–µ–ª—å—é —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è –∏ —É–ø—Ä–æ—â–µ–Ω–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏ –¥–æ–æ–±—É—á–µ–Ω–∏–∏ –º–æ–¥–µ–ª–∏.

–î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞ Geo Reviews Dataset 2023 –∏–∑ Hugging Face Datasets, –º–æ–∂–Ω–æ —Å–ª–µ–¥–æ–≤–∞—Ç—å –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω–æ–º—É —à–∞–≥—É –∑–∞ —à–∞–≥–æ–º –ø—Ä–æ—Ü–µ—Å—Å—É, –æ–ø–∏—Å–∞–Ω–Ω–æ–º—É –Ω–∏–∂–µ. –≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –≤–∫–ª—é—á–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É –¥–∞—Ç–∞—Å–µ—Ç–∞, –µ–≥–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ —Ñ–æ—Ä–º–∞—Ç DataFrame –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏.

**–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞**

1. **–ò–º–ø–æ—Ä—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫**:
   –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏ –∏ DataFrame –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –º–æ–¥—É–ª–∏ –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫ `datasets` –∏ `pandas`.

   ```python
   from datasets import load_dataset
   import pandas as pd
   ```

2. **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞**:
   –ò—Å–ø–æ–ª—å–∑—É—è —Ñ—É–Ω–∫—Ü–∏—é `load_dataset` –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `datasets`, –∑–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞—Ç–∞—Å–µ—Ç, —É–∫–∞–∑–∞–≤ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä `d0rj/geo-reviews-dataset-2023`. –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –∑–∞–≥—Ä—É–∑–∏—Ç –¥–∞—Ç–∞—Å–µ—Ç –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ. –ü–∞—Ä–∞–º–µ—Ç—Ä `cache_dir` –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–∫–∞–∑–∞—Ç—å –∫–∞—Ç–∞–ª–æ–≥ –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ —É—Å–∫–æ—Ä—è–µ—Ç –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —Å–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —Å–µ—Ç—å.

   ```python
   from pathlib import Path

    DATA_PATH = Path('data/finetune_gpt/')
    DATA_PATH.mkdir(parents=True, exist_ok=True)

   dataset = load_dataset("d0rj/geo-reviews-dataset-2023", cache_dir=DATA_PATH / 'model_cache')
   ```

   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É–∫–∞–∑–∞–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫—ç—à–∞, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö.

3. **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ DataFrame**:
   –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞, —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ `train` (—Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ) –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ `DataFrame` —Å –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `pandas`. –≠—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–∫ –∫–∞–∫ `DataFrame` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —É–¥–æ–±–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö.

   ```python
   data_df = pd.DataFrame(dataset['train'])
   ```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>address</th>
      <th>name_ru</th>
      <th>rating</th>
      <th>rubrics</th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥, —É–ª. –ú–æ—Å–∫–æ–≤—Å–∫–∞—è / —É–ª. –í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫...</td>
      <td>–ú–æ—Å–∫–æ–≤—Å–∫–∏–π –∫–≤–∞—Ä—Ç–∞–ª</td>
      <td>3</td>
      <td>–ñ–∏–ª–æ–π –∫–æ–º–ø–ª–µ–∫—Å</td>
      <td>–ú–æ—Å–∫–æ–≤—Å–∫–∏–π –∫–≤–∞—Ä—Ç–∞–ª 2.\n–®—É–º–Ω–æ : –ª–µ—Ç–æ–º –ø–æ –Ω–æ—á–∞–º ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å, –≠–ª–µ–∫—Ç—Ä–æ—Å—Ç–∞–ª—å, –ø—Ä–æ—Å–ø–µ–∫—Ç –õ–µ–Ω...</td>
      <td>–ü—Ä–æ–¥—É–∫—Ç—ã –ï—Ä–º–æ–ª–∏–Ω–æ</td>
      <td>5</td>
      <td>–ú–∞–≥–∞–∑–∏–Ω –ø—Ä–æ–¥—É–∫—Ç–æ–≤;–ü—Ä–æ–¥—É–∫—Ç—ã –≥–ª—É–±–æ–∫–æ–π –∑–∞–º–æ—Ä–æ–∑–∫–∏;...</td>
      <td>–ó–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–∞—è —Å–µ—Ç—å –º–∞–≥–∞–∑–∏–Ω–æ–≤ –≤ –æ–±—â–µ–º, —Ö–æ—Ä–æ—à–∏–π ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä, –ü—Ä–∏–∫—É–±–∞–Ω—Å–∫–∏–π –≤–Ω—É—Ç—Ä–∏–≥–æ—Ä–æ–¥—Å–∫–æ–π –æ–∫—Ä—É–≥,...</td>
      <td>LimeFit</td>
      <td>1</td>
      <td>–§–∏—Ç–Ω–µ—Å-–∫–ª—É–±</td>
      <td>–ù–µ –∑–Ω–∞—é —Å–º—É—Ç—è—Ç –ª–∏ –∫–æ–≥–æ-—Ç–æ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞, –Ω–æ —è...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –ø—Ä–æ—Å–ø–µ–∫—Ç –≠–Ω–≥–µ–ª—å—Å–∞, 111, –∫–æ—Ä–ø. 1</td>
      <td>Snow-Express</td>
      <td>4</td>
      <td>–ü—É–Ω–∫—Ç –ø—Ä–æ–∫–∞—Ç–∞;–ü—Ä–æ–∫–∞—Ç –≤–µ–ª–æ—Å–∏–ø–µ–¥–æ–≤;–°–∞–ø—Å—ë—Ä—Ñ–∏–Ω–≥</td>
      <td>–•–æ—Ä–æ—à–∏–µ —É—Å–ª–æ–≤–∏—è –∞—Ä–µ–Ω–¥—ã. \n–î—Ä—É–∂–µ–ª—é–±–Ω—ã–π –ø–µ—Ä—Å–æ–Ω–∞–ª...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>–¢–≤–µ—Ä—å, –í–æ–ª–æ–∫–æ–ª–∞–º—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç, 39</td>
      <td>–°—Ç—É–¥–∏—è Beauty Brow</td>
      <td>5</td>
      <td>–°–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã;–í–∏–∑–∞–∂–∏—Å—Ç—ã, —Å—Ç–∏–ª–∏—Å—Ç—ã;–°–∞–ª–æ–Ω –±—Ä–æ–≤–µ–π...</td>
      <td>–¢–æ–ø –º–∞—Å—Ç–µ—Ä –ê–Ω–≥–µ–ª–∏–Ω–∞ —Ç–æ–ø –≤–æ –≤—Å–µ—Ö —Å–º—ã—Å–ª–∞—Ö ) –ù–µ–º–Ω...</td>
    </tr>
  </tbody>
</table>
</div>

–î–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞ –∫ –ø—Ä–æ—Ü–µ—Å—Å—É –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ GPT-2 –±—ã–ª –≤—ã–ø–æ–ª–Ω–µ–Ω —Å–ª–µ–¥—É—é—â–∏–π –ø—Ä–µ–¥–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö:

1. **–£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π**: –í –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å, –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞ —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ –∑–∞–ø–∏—Å–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –¥–∞–Ω–Ω—ã–µ –≤ –∫–ª—é—á–µ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö ‚Äî `text`, `name_ru`, –∏ `rating`. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω–æ—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª—É—á–∞—è –∏ –∏—Å–∫–ª—é—á–∞–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º –≤–∞–∂–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

   ```python
   work_data = data_df.dropna(subset=['text', 'name_ru', 'rating'])
   ```

2. **–£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤**: –î–∞–ª–µ–µ –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞ —É–¥–∞–ª—è—é—Ç—Å—è –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ —Å—Ç–æ–ª–±—Ü—É `text`. –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∏–∑–±—ã—Ç–æ—á–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –æ—Ç–∑—ã–≤–æ–≤, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–≥–ª–æ –±—ã –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–∏ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ñ—Ä–∞–∑–∞—Ö –∏–ª–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è—Ö.

   ```python
   work_data = work_data.drop_duplicates(subset=['text']).reset_index(drop=True)
   ```

3. **–ó–∞–º–µ–Ω–∞ –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫**: –í —Ç–µ–∫—Å—Ç–∞—Ö –æ—Ç–∑—ã–≤–æ–≤ –∑–∞–º–µ–Ω—è—é—Ç—Å—è —Å–∏–º–≤–æ–ª—ã –ø–µ—Ä–µ–Ω–æ—Å–∞ —Å—Ç—Ä–æ–∫–∏ (`\\n`) –Ω–∞ –ø—Ä–æ–±–µ–ª—ã. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç —Ç–µ–∫—Å—Ç—ã –±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–º–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–æ–¥–µ–ª—å—é, —Ç–∞–∫ –∫–∞–∫ –∏–∑–±–∞–≤–ª—è–µ—Ç—Å—è –æ—Ç –ª–∏—à–Ω–∏—Ö —Ä–∞–∑—Ä—ã–≤–æ–≤ –∏ –¥–µ–ª–∞–µ—Ç —Ç–µ–∫—Å—Ç –±–æ–ª–µ–µ –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–º.

   ```python
   work_data['text'] = work_data['text'].str.replace('\\n', ' ')
   ```

4. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö**: –ù–∞–∫–æ–Ω–µ—Ü, –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø–µ—Ä–≤—ã–µ 15,000 –∑–∞–ø–∏—Å–µ–π –∏–∑ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –±–æ–ª–µ–µ —É–ø—Ä–∞–≤–ª—è–µ–º—ã–º –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ –±—ã—Å—Ç—Ä–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å –º–æ–¥–µ–ª—å—é.

   ```python
   work_data = work_data[:15000]
   ```

## –û–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏

–í –¥–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–¥–µ–ª—å [`ai-forever/rugpt3small_based_on_gpt2`](https://huggingface.co/ai-forever/rugpt3small_based_on_gpt2), –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ GPT-2, —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–æ–æ–±—É—á–µ–Ω–Ω–∞—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ–∫—Å—Ç–∞–º–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –≠—Ç–∞ –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∏—Ç–µ—Ä–∞—Ü–∏—é –∏–∑–≤–µ—Å—Ç–Ω–æ–π —Å–µ—Ä–∏–∏ –º–æ–¥–µ–ª–µ–π GPT (Generative Pre-trained Transformer), —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö OpenAI. –û—Å–Ω–æ–≤–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å GPT –º–æ–¥–µ–ª–µ–π ‚Äî —ç—Ç–æ –∏—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç, –ø—Ä–æ–¥–æ–ª–∂–∞—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –≤–≤–æ–¥. –≠—Ç–æ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –±–ª–∞–≥–æ–¥–∞—Ä—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ —É—á–∏—Ç—ã–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤—Å–µ–≥–æ –≤–≤–µ–¥–µ–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.

### –ü—Ä–æ—Ü–µ—Å—Å –¥–æ–æ–±—É—á–µ–Ω–∏—è

–î–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—â–∏–µ —è–∑—ã–∫–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –∑–∞–¥–∞—á–∞–º. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ, –¥–æ–æ–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–≤–æ–¥–∏–ª–æ—Å—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–∑—ã–≤–æ–≤ –æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏—è—Ö –≤ –†–æ—Å—Å–∏–∏. –î–ª—è –¥–æ–æ–±—É—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –Ω–µ —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç—ã —Å–∞–º–∏—Ö –æ—Ç–∑—ã–≤–æ–≤, –Ω–æ –∏ —Å–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ, —Ç–∞–∫–∏–µ –∫–∞–∫ –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è, –µ–≥–æ —Ä—É–±—Ä–∏–∫–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞.

```python
import pandas as pd
from transformers import GPT2LMHeadModel, GPT2Tokenizer, TextDataset, DataCollatorForLanguageModeling, Trainer, TrainingArguments
from pathlib import Path

class FineTuner:
    def __init__(self, 
                 model_name='ai-forever/rugpt3small_based_on_gpt2', 
                 cache_dir='model_cache',
                 data_path=DATA_PATH):
        self.data_path = Path(data_path)
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞ –∏ –º–æ–¥–µ–ª–∏
        self.tokenizer = GPT2Tokenizer.from_pretrained(model_name, cache_dir=str(self.data_path / cache_dir))
        self.model = GPT2LMHeadModel.from_pretrained(model_name, cache_dir=str(self.data_path / cache_dir))

    def prepare_data(self, df):
        """
        –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
        """
        # –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø—Ä–æ–±–ª–µ–º—ã –∏ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        df['input'] = df.apply(
            lambda row: f"<name_ru> {row['name_ru']} <rubrics> {row['rubrics']} <rating> {row['rating']} {self.tokenizer.eos_token}", axis=1
            )
        
        # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫ —Ü–µ–ª–µ–≤–æ–º—É —Ç–µ–∫—Å—Ç—É —Ç–æ–∫–µ–Ω–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å—Ç—Ä–æ–∫–∏
        df['output'] = df.apply(lambda row: f" <text> {row['text']} {self.tokenizer.eos_token}", axis=1)
        
        # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—É—Ç–∏ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
        dataset_path = self.data_path / 'train_dataset.txt'
        # –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–∞–π–ª
        with dataset_path.open('w', encoding='utf-8') as file:
            for input_text, target_text in zip(df['input'], df['output']):
                file.write(input_text + ' ' + target_text + '\n')
        return dataset_path

    def fine_tune(self, 
                  dataset_path, 
                  output_name='fine_tuned_model', 
                  num_train_epochs=4, 
                  per_device_train_batch_size=4, 
                  learning_rate=5e-5, 
                  save_steps=10_000):
        """
        –î–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –∑–∞–¥–∞–Ω–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ.
        """
        train_dataset = TextDataset(
            tokenizer=self.tokenizer,
            file_path=str(dataset_path),
            block_size=256
        )

        data_collator = DataCollatorForLanguageModeling(
            tokenizer=self.tokenizer, mlm=False
        )

        training_args = TrainingArguments(
            output_dir=str(self.data_path / output_name),
            overwrite_output_dir=True,
            num_train_epochs=num_train_epochs,
            per_device_train_batch_size=per_device_train_batch_size,
            save_steps=save_steps,
            learning_rate=learning_rate,
            save_total_limit=2,
            logging_dir=str(self.data_path / 'logs'),
        )

        trainer = Trainer(
            model=self.model,
            args=training_args,
            data_collator=data_collator,
            train_dataset=train_dataset,
        )

        trainer.train()
        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –∏ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞
        self.model.save_pretrained(str(self.data_path / output_name))
        self.tokenizer.save_pretrained(str(self.data_path / output_name))
```

### –ú–µ—Ç–æ–¥—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞

–ö–ª–∞—Å—Å `TextGenerator`, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞, –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å —Å –ø–æ–º–æ—â—å—é —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:
- **max_length** –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.
- **num_return_sequences** –∑–∞–¥–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ç–µ–∫—Å—Ç–∞, –∫–æ—Ç–æ—Ä–æ–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ.
- **temperature** –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –≤—ã–≤–æ–¥–∞, —Å –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏, —Å–æ–∑–¥–∞–≤–∞—è –±–æ–ª–µ–µ —Å–ª—É—á–∞–π–Ω—ã–µ –∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã.
- **top_k** –∏ **top_p** –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã–±–æ—Ä–∫–æ–π —Å–ª–æ–≤. `top_k` –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤—ã–±–æ—Ä–∫—É K –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ `top_p` –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—ã–π nucleus sampling, –ø–æ–∑–≤–æ–ª—è—è –≤—ã–±–∏—Ä–∞—Ç—å —Å–ª–æ–≤–∞ —Å –Ω–∞–∏–±–æ–ª—å—à–µ–π –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–æ–ª–µ–µ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç.
- **do_sample** –≤–∫–ª—é—á–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—É—é –≤—ã–±–æ—Ä–∫—É —Å–ª–æ–≤ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.

```python
from transformers import GPT2LMHeadModel, GPT2Tokenizer
from pathlib import Path

class TextGenerator:
    def __init__(self, model_name='fine_tuned_model', data_path=DATA_PATH):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ –∏ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞.
        –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥–µ–ª—å –∏ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –ø—É—Ç–∏.
        """
        model_path = Path(data_path) / model_name
        self.tokenizer = GPT2Tokenizer.from_pretrained(str(model_path))
        self.model = GPT2LMHeadModel.from_pretrained(str(model_path))
        self.model.eval()

    def generate_text(self, 
                    name_ru: str, 
                    rubrics: str, 
                    rating: int,
                    max_length=100, 
                    num_return_sequences=1, 
                    temperature=1.0, 
                    top_k=0, 
                    top_p=1.0, 
                    do_sample=False):
        """
        –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ (prompt) –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.
        
        –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
        - name_ru: –ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏.
        - rubrics: –°–ø–∏—Å–æ–∫ —Ä—É–±—Ä–∏–∫, –∫ –∫–æ—Ç–æ—Ä—ã–º –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è.
        - rating: –û—Ü–µ–Ω–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
        - max_length: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.
        - num_return_sequences: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π.
        - temperature: –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –≤—ã–≤–æ–¥–∞.
        - top_k: –ï—Å–ª–∏ –±–æ–ª—å—à–µ 0, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ —Ç–æ–ª—å–∫–æ k –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏.
        - top_p: –ï—Å–ª–∏ –º–µ–Ω—å—à–µ 1.0, –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è nucleus sampling.
        - do_sample: –ï—Å–ª–∏ True, –≤–∫–ª—é—á–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—É—é –≤—ã–±–æ—Ä–∫—É –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è.
        """
        # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ prompt
        prompt_text = f"<name_ru> {name_ru} <rubrics> {rubrics} <rating> {rating} {self.tokenizer.eos_token} <text> "
        
        # –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ, –ø—Ä–∏–≥–æ–¥–Ω–æ–º –¥–ª—è –º–æ–¥–µ–ª–∏
        encoded_input = self.tokenizer.encode(prompt_text, return_tensors='pt')
        
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤
        outputs = self.model.generate(
            encoded_input,
            max_length=max_length + len(encoded_input[0]),
            num_return_sequences=num_return_sequences,
            temperature=temperature,
            top_k=top_k,
            top_p=top_p,
            do_sample=do_sample,
            no_repeat_ngram_size=2
        )
        
        # –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        all_texts = [self.tokenizer.decode(output, skip_special_tokens=True) for output in outputs]
        
        # –£–¥–∞–ª–µ–Ω–∏–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤
        prompt_length = len(self.tokenizer.decode(encoded_input[0], skip_special_tokens=True))
        trimmed_texts = [text[prompt_length:] for text in all_texts]
        
        # –í–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –≤–∏–¥–µ —Å–ª–æ–≤–∞—Ä—è
        return {
            "full_texts": all_texts,
            "generated_texts": trimmed_texts
        }
```

<details>
  <summary>–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞</summary>

–ü–∞—Ä–∞–º–µ—Ç—Ä `do_sample=True` –≤ –º–µ—Ç–æ–¥–µ `generate()` –º–æ–¥–µ–ª–µ–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ Transformers –æ—Ç Hugging Face –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç, –±—É–¥–µ—Ç –ª–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–ª—É—á–∞–π–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ —Å–ª–æ–≤. –≠—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –≤–∞–∂–µ–Ω –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∏–ª–µ–º –∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ–º –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.

### –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ `do_sample`:

–ö–æ–≥–¥–∞ `do_sample` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `False`, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—É—Ç—ë–º –≤—ã–±–æ—Ä–∞ –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω–æ–≥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–ª–æ–≤–∞ –≤ –∫–∞–∂–¥–æ–º —à–∞–≥–µ, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –≤—ã–≤–æ–¥ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –ø–æ–ª–µ–∑–µ–Ω, –∫–æ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π –∏ –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω—ã–π —Ç–µ–∫—Å—Ç.

–û–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `do_sample=True`, –º–æ–¥–µ–ª—å –Ω–∞—á–Ω—ë—Ç –≤—ã–±–∏—Ä–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Å–ª–æ–≤–∞ –∏–∑ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª–æ–≥–∏—Ç–æ–≤ –º–æ–¥–µ–ª–∏. –≠—Ç–æ –≤–Ω–æ—Å–∏—Ç —ç–ª–µ–º–µ–Ω—Ç —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –º–µ–Ω–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º –∏ –±–æ–ª–µ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–º.

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç `do_sample=True`:

1. **–ë–µ–∑ `do_sample`**: –í—ã–±–æ—Ä–∫–∞ —Å–ª–æ–≤–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å—Ç—Ä–æ–≥–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–∏–≤—ã—Å—à–µ–≥–æ –ª–æ–≥–∏—Ç–∞ (–∏–ª–∏ –ø–æ—Å–ª–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ª–æ–≥–∏—Ç–æ–≤ –≤ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏, –Ω–∞–∏–±–æ–ª—å—à–µ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏).

2. **–° `do_sample`**:
   - –ú–æ–¥–µ–ª—å –≤—ã—á–∏—Å–ª—è–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–≥–æ –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–ª–æ–≤–∞.
   - –°–ª–µ–¥—É—é—â–µ–µ —Å–ª–æ–≤–æ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ, –Ω–æ —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è–º–∏, –≤–∑–≤–µ—à–µ–Ω–Ω—ã–º–∏ –ø–æ –∏—Ö —Ä–∞—Å—á—ë—Ç–Ω—ã–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è–º.

### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ `do_sample` —Å –¥—Ä—É–≥–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

- **`temperature`**: –ò–∑–º–µ–Ω—è–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π, —É–ø—Ä–∞–≤–ª—è—è "—Ä–µ–∑–∫–æ—Å—Ç—å—é" –∏–ª–∏ "–ø–ª–æ—Å–∫–æ—Å—Ç—å—é" —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è. –ë–æ–ª–µ–µ –≤—ã—Å–æ–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –¥–µ–ª–∞–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–æ–ª–µ–µ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–º, —Ç–µ–º —Å–∞–º—ã–º —É–≤–µ–ª–∏—á–∏–≤–∞—è —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å.
- **`top_k`**: –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤—ã–±–æ—Ä–∫—É –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è, –¥–æ `k` –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã—Ö —Å–ª–æ–≤.
- **`top_p` (nucleus sampling)**: –í–º–µ—Å—Ç–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–ª–æ–≤ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤—ã–±–æ—Ä–∫—É –¥–æ –Ω–∞–±–æ—Ä–∞ —Å–ª–æ–≤, —Å—É–º–º–∞—Ä–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–µ–≤—ã—à–∞–µ—Ç –∑–∞–¥–∞–Ω–Ω—ã–π –ø–æ—Ä–æ–≥ `p`.

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç `temperature`, `top_k` –∏ `top_p` –≤–º–µ—Å—Ç–µ

1. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ `temperature`:**
   - –ù–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –¥—Ä—É–≥–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, `temperature` –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π —Å–ª–æ–≤ –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –∫–∞–∫–∞—è-–ª–∏–±–æ –≤—ã–±–æ—Ä–∫–∞. 
   - –ï—Å–ª–∏ `temperature` —Ä–∞–≤–Ω–∞ 1, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è. –ó–Ω–∞—á–µ–Ω–∏–µ –º–µ–Ω—å—à–µ 1 –¥–µ–ª–∞–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–æ–ª–µ–µ "–ø–∏–∫–æ–≤—ã–º" (–ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ –±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã–º —Å–ª–æ–≤–∞–º), –∞ –∑–Ω–∞—á–µ–Ω–∏–µ –±–æ–ª—å—à–µ 1 ‚Äî –±–æ–ª–µ–µ "—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–º" (–ø–æ–≤—ã—à–µ–Ω–∏–µ —à–∞–Ω—Å–æ–≤ –º–µ–Ω–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã—Ö —Å–ª–æ–≤).

2. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ `top_k`:**
   - –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è `temperature`, –µ—Å–ª–∏ `top_k` –±–æ–ª—å—à–µ 0, –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Å–ª–æ–≤ –¥–æ `k` –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã—Ö. –≠—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤—ã–±–æ—Ä–∫—É —Ç–æ–ª—å–∫–æ —Å–∞–º—ã–º–∏ –≤–µ—Ä–æ—è—Ç–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏ –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è `temperature`.

3. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ `top_p` (nucleus sampling):**
   - `top_p` —Ç–∞–∫–∂–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ `temperature`. –û–Ω —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –Ω–∞–∏–º–µ–Ω—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤, —Å—É–º–º–∞—Ä–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–µ–≤—ã—à–∞–µ—Ç `p`. –≠—Ç–æ —Å–æ–∑–¥–∞–µ—Ç "—è–¥–µ—Ä–Ω–æ–µ" —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, –≤–∫–ª—é—á–∞—é—â–µ–µ —Ç–æ–ª—å–∫–æ –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã–µ —Å–ª–æ–≤–∞ –¥–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ—Ä–æ–≥–∞ `p`.

### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
–ö–æ–≥–¥–∞ `top_k` –∏ `top_p` –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–æ–º—É –∏–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π. –ù–∞–ø—Ä–∏–º–µ—Ä:
- –ï—Å–ª–∏ `top_k=10` –∏ `top_p=0.5`, –∏ –ø–µ—Ä–≤—ã–µ 10 —Å–ª–æ–≤ –ø–æ–∫—Ä—ã–≤–∞—é—Ç 70% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π, —Ç–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è `top_k`, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—è –≤—ã–±–æ—Ä–∫—É 10 —Å–ª–æ–≤–∞–º–∏.
- –ï—Å–ª–∏ `top_k=50` –∏ `top_p=0.5`, –∏ –ø–µ—Ä–≤—ã–µ 10 —Å–ª–æ–≤ —É–∂–µ –ø–æ–∫—Ä—ã–≤–∞—é—Ç 55% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π, —Ç–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è `top_p`, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—è –≤—ã–±–æ—Ä–∫—É –ø–µ—Ä–≤—ã–º–∏ 10 —Å–ª–æ–≤–∞–º–∏, –¥–∞–∂–µ –µ—Å–ª–∏ `top_k` –ø–æ–∑–≤–æ–ª—è–µ—Ç –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–π –≤—ã–±–æ—Ä.

</details>

**–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏:**

–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø—Ä–æ–≤–æ–¥–∏–ª–æ—Å—å –Ω–∞ –º–æ—â–Ω–æ–π –º–∞—à–∏–Ω–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã Tesla A-100, –∞ —Ç–∞–∫–∂–µ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π QUDA, —á—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä–∏–ª–æ –ø—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è. –ü—Ä–∏ —ç—Ç–æ–º –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è —Å–æ—Å—Ç–∞–≤–∏–ª–∞ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ 20 –º–∏–Ω—É—Ç. –°—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ QUDA –ø–æ–º–æ–≥–∞–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–∞ GPU, —á—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –±–æ–ª—å—à–∏–º–∏ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏.

–≠—Ç–æ –≤–∞–∂–Ω—ã–π –∞—Å–ø–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å–ª–µ–¥—É–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å –ø—Ä–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞. –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –º–∞—à–∏–Ω–∞—Ö –±–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ QUDA –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π —É—Å–∫–æ—Ä–µ–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –Ω–∞ –±–æ–ª–µ–µ —Å–ª–∞–±—ã—Ö –≤–∏–¥–µ–æ–∫–∞—Ä—Ç–∞—Ö –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏. –ï—Å–ª–∏ –≤—ã —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞, –±—É–¥—å—Ç–µ –≥–æ—Ç–æ–≤—ã –∫ —Ç–æ–º—É, —á—Ç–æ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è –º–æ–∂–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å—Å—è, —á—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –≤—Ä–µ–º–µ–Ω–∏. 

–¢–∞–∫–∂–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–±–ª–∞—á–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ —Å GPU –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏, –µ—Å–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã –∏–ª–∏ –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å–∫–æ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è. –≠—Ç–æ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –≤—ã–≥–æ–¥–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π.

```python
finetuner = FineTuner()
dataset_path = finetuner.prepare_data(work_data)
finetuner.fine_tune(dataset_path, output_name='fine_tuned_model_gpt_2')

```

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –∫–∞—á–µ—Å—Ç–≤–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞ –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –Ω–∞—à–µ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞, –≤–∫–ª—é—á–∞—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. –í—ã–±–æ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–π –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –±—ã–ª–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```python
unique_name_ru = work_data['name_ru'].unique().tolist()
unique_rubrics = work_data['rubrics'].unique().tolist()
```
```python
unique_name_ru[:10]
```
```txt
['–ú–æ—Å–∫–æ–≤—Å–∫–∏–π –∫–≤–∞—Ä—Ç–∞–ª',
 '–ü—Ä–æ–¥—É–∫—Ç—ã –ï—Ä–º–æ–ª–∏–Ω–æ',
 'LimeFit',
 'Snow-Express',
 '–°—Ç—É–¥–∏—è Beauty Brow',
 'Tele2',
 '–£ —Ç–µ—â–∏',
 'Smoking Park',
 'Jinju',
 'Kari –ì–ò–ü–ï–†']
```
```python
unique_rubrics[:10]
```
```txt
['–ñ–∏–ª–æ–π –∫–æ–º–ø–ª–µ–∫—Å',
 '–ú–∞–≥–∞–∑–∏–Ω –ø—Ä–æ–¥—É–∫—Ç–æ–≤;–ü—Ä–æ–¥—É–∫—Ç—ã –≥–ª—É–±–æ–∫–æ–π –∑–∞–º–æ—Ä–æ–∑–∫–∏;–ú–∞–≥–∞–∑–∏–Ω –º—è—Å–∞, –∫–æ–ª–±–∞—Å',
 '–§–∏—Ç–Ω–µ—Å-–∫–ª—É–±',
 '–ü—É–Ω–∫—Ç –ø—Ä–æ–∫–∞—Ç–∞;–ü—Ä–æ–∫–∞—Ç –≤–µ–ª–æ—Å–∏–ø–µ–¥–æ–≤;–°–∞–ø—Å—ë—Ä—Ñ–∏–Ω–≥',
 '–°–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã;–í–∏–∑–∞–∂–∏—Å—Ç—ã, —Å—Ç–∏–ª–∏—Å—Ç—ã;–°–∞–ª–æ–Ω –±—Ä–æ–≤–µ–π –∏ —Ä–µ—Å–Ω–∏—Ü',
 '–û–ø–µ—Ä–∞—Ç–æ—Ä —Å–æ—Ç–æ–≤–æ–π —Å–≤—è–∑–∏;–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø—Ä–æ–≤–∞–π–¥–µ—Ä',
 '–ö–∞—Ñ–µ',
 '–í–µ–π–ø-—à–æ–ø;–ú–∞–≥–∞–∑–∏–Ω —Ç–∞–±–∞–∫–∞ –∏ –∫—É—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–µ–π',
 '–ö–∞—Ñ–µ;–ö–æ—Ñ–µ–π–Ω—è',
 '–ú–∞–≥–∞–∑–∏–Ω –æ–±—É–≤–∏;–Æ–≤–µ–ª–∏—Ä–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω;–î–µ—Ç—Å–∫–∏–µ –∏–≥—Ä—É—à–∫–∏ –∏ –∏–≥—Ä—ã']
```

–î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–æ–≤ –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ TextGenerator, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å –¥–æ–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é GPT-2. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±—ã–ª–∏ –≤—ã–±—Ä–∞–Ω—ã —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∏ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ –º–µ–∂–¥—É —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ–º –∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å—é —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤:

```python
name_ru = unique_name_ru[1]
rubrics = unique_rubrics[1]
rating = 1

generator = TextGenerator(
    model_name='fine_tuned_model_gpt_2',
    data_path=DATA_PATH
)
generated_texts = generator.generate_text(
    name_ru=name_ru,
    rubrics=rubrics,
    rating=rating,
    max_length=100,
    num_return_sequences=3,
    do_sample=True,
    temperature=0.95,  # –°–ª–µ–≥–∫–∞ —É–º–µ–Ω—å—à–∞–µ–º —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å
    top_k=10,         # –£–º–µ–Ω—å—à–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º—ã—Ö –≤–µ—Ä—Ö–Ω–∏—Ö k —Å–ª–æ–≤
    top_p=0.95        # –£–º–µ–Ω—å—à–∞–µ–º "—è–¥–µ—Ä–Ω–æ—Å—Ç—å" —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
)
for i, text in enumerate(generated_texts['generated_texts']):
    print(f"Generated Text {i+1}: {text}")
```

**–í—ã–≤–æ–¥ 3 –≥–µ–Ω–µ—Ä–∞—Ü–∏–π —Å —Ä–µ–π—Ç–∏–Ω–≥–æ–º 5:**

```txt
Generated Text 1:  –í –º–∞–≥–∞–∑–∏–Ω–µ –µ—Å—Ç—å –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –¥–ª—è –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è —à–∞—à–ª—ã–∫–∞, —Å–∞–ª–∞—Ç–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö –±–ª—é–¥ –Ω–∞ —É–≥–ª—è—Ö.  –û—á–µ–Ω—å –≤–∫—É—Å–Ω–∞—è –≤—ã–ø–µ—á–∫–∞, –µ—Å—Ç—å –≤—ã–ø–µ—á–∫–∏ –Ω–∞ —Ä–∞–∑–≤–µ—Å, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –≤–∑—è—Ç—å —Å —Å–æ–±–æ–π, —Ç–∞–∫ –∂–µ –º–æ–∂–Ω–æ –ø—Ä–∏–æ–±—Ä–µ—Å—Ç–∏ –∫—É–ª–∏–Ω–∞—Ä–Ω—ã–µ –∫–Ω–∏–≥–∏. –ï—Å—Ç—å –º–∞–≥–∞–∑–∏–Ω—á–∏–∫, –≥–¥–µ –º–æ–∂–Ω–æ –∫—É–ø–∏—Ç—å —Å—É—Ö–æ—Ñ—Ä—É–∫—Ç—ã. –ü—Ä–æ–¥–∞–≤—Ü—ã –≤–µ–∂–ª–∏–≤—ã–µ, –¥–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ, –æ—á–µ–Ω—å –ø—Ä–∏—è—Ç–Ω–æ –æ–±—â–∞—Ç—å—Å—è! üëçüèª  –°–ø–∞—Å–∏–±–æ –≤–∞–º!!!  –ò –Ω–µ –∑–∞–±—É–¥—å—Ç–µ –∫—É–ø–∏—Ç—å –≤–æ–¥—Éü•∞  

Generated Text 2:  –û—á–µ–Ω—å —É–¥–æ–±–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –º–∞–≥–∞–∑–∏–Ω.  –ü–µ—Ä—Å–æ–Ω–∞–ª –æ—á–µ–Ω—å –ø—Ä–∏–≤–µ—Ç–ª–∏–≤—ã–π –∏ –≤–µ–∂–ª–∏–≤—ã–π.  

Generated Text 3:  –í –º–∞–≥–∞–∑–∏–Ω–µ —á–∏—Å—Ç–æ, –ø–µ—Ä—Å–æ–Ω–∞–ª –ø—Ä–∏–≤–µ—Ç–ª–∏–≤—ã–π –∏ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã–π. –ï—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∞ –∏ —Å–∞–º–æ–≤—ã–≤–æ–∑.  –¶–µ–Ω—ã –ø—Ä–∏–µ–º–ª–µ–º—ã–µ, –≤—Å–µ–≥–¥–∞ —Å–≤–µ–∂–∏–µ –ø—Ä–æ–¥—É–∫—Ç—ã. –ê—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç –≤—Å–µ–≥–¥–∞ —à–∏—Ä–æ–∫–∏–π. –í—Å–µ–≥–¥–∞ –µ—Å—Ç—å –∞–∫—Ü–∏–∏ –∏ –∞–∫—Ü–∏–∏. –°–ø–∞—Å–∏–±–æ –∑–∞ —Ä–∞–±–æ—Ç—É. –í—Å–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥—É—é. –†–µ–∫–æ–º–µ–Ω–¥—É—é.  
```

**–í—ã–≤–æ–¥ 3 –≥–µ–Ω–µ—Ä–∞—Ü–∏–π —Å —Ä–µ–π—Ç–∏–Ω–≥–æ–º 1:**

```txt
Generated Text 1:  –ù–∞ –∫–∞—Å—Å–µ –º–Ω–µ —Å–∫–∞–∑–∞–ª–∏, —á—Ç–æ –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø—Ä–æ–¥—É–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –µ—Å—Ç—å —É –Ω–∏—Ö –≤ –Ω–∞–ª–∏—á–∏–∏.  –≠—Ç–æ –Ω–µ —Ç–∞–∫.   –í –º–∞–≥–∞–∑–∏–Ω–µ –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π —è –±—ã –æ–±—Ä–∞—Ç–∏–ª–∞ –≤–Ω–∏–º–∞–Ω–∏–µ. –ê –µ—Å–ª–∏ –±—ã –æ–Ω –ø–æ—è–≤–∏–ª—Å—è, —Ç–æ —è —É–∂–µ –±—ã–ª–∞ –±—ã –ø–æ—Ä–∞–∂–µ–Ω–∞, –∫–∞–∫ –º–Ω–µ –ø–æ–≤–µ–∑–ª–æ.   

Generated Text 2:  –ù–∞ –ø—Ä–∏–ª–∞–≤–∫–∞—Ö –ª–µ–∂–∞—Ç –ø—Ä–æ–¥—É–∫—Ç—ã –ø–∏—Ç–∞–Ω–∏—è –∏ —Ç–æ–≤–∞—Ä—ã –¥–ª—è –¥–æ–º–∞.  –ü—Ä–æ–¥–∞–≤—Ü—ã –≥—Ä—É–±–∏—è–Ω–∫–∏, –≤–µ—á–Ω–æ —Ö–æ–¥—è—Ç —Å –Ω–µ–¥–æ–≤–æ–ª—å–Ω—ã–º –ª–∏—Ü–æ–º. –Ø –±—ã —Å–∫–∞–∑–∞–ª–∞ —á—Ç–æ –æ–Ω–∏ –Ω–µ –∑–Ω–∞—é—Ç —á—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ.  

Generated Text 3:  1. –û—Ç–≤—Ä–∞—Ç–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –ø–æ–∫—É–ø–∞—Ç–µ–ª—é. 2. –ú–∞–≥–∞–∑–∏–Ω—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç —Ç–æ–≤–∞—Ä–∞. 3. –ö–∞—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –æ—Å—Ç–∞–≤–ª—è–µ—Ç –∂–µ–ª–∞—Ç—å –ª—É—á—à–µ–≥–æ. 4. –ü—Ä–æ–¥–∞–≤—Ü—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –º–∞–≥–∞–∑–∏–Ω–µ, –Ω–µ –∑–Ω–∞—é—Ç —Å–≤–æ—é —Ä–∞–±–æ—Ç—É.  4. –ú–∞–≥–∞–∑–∏–Ω–∞–º, —É –∫–æ—Ç–æ—Ä—ã—Ö –≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –º–∞–≥–∞–∑–∏–Ω, –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—é. –≠—Ç–æ —Å–¥–µ–ª–∞–Ω–æ. 5. –ù–∞ –ø–æ–ª–∫–∞—Ö –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –±—ã –≤ –Ω–∞–ª–∏—á–∏–∏. –ï—Å–ª–∏ –±—ã —è –Ω–µ –∑–Ω–∞–ª–∞ —á—Ç–æ –º–Ω–µ –Ω—É–∂–µ–Ω —Ç–æ–≤–∞—Ä, —è –±—ã –µ–≥–æ –Ω–µ –∫—É–ø–∏–ª–∞.  

```

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±—ã–ª–∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –≤–∏–∑—É–∞–ª—å–Ω–æ, –±–µ–∑ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏. –í —Ä–∞–º–∫–∞—Ö –¥–∞–Ω–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –Ω–∞—à–∞ —Ü–µ–ª—å –∑–∞–∫–ª—é—á–∞–ª–∞—Å—å –Ω–µ –≤ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–æ—á–Ω–æ–π –º–æ–¥–µ–ª–∏, –∞ –≤ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–µ. –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∑–≤–æ–ª–∏–ª —Å–¥–µ–ª–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è:

- –¢–µ–∫—Å—Ç—ã —Å –æ—Ü–µ–Ω–∫–æ–π "5" –æ—Ç—Ä–∞–∂–∞–µ—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—è –≤—ã—Å–æ–∫–æ–π –æ—Ü–µ–Ω–∫–µ.
- –¢–µ–∫—Å—Ç—ã —Å –æ—Ü–µ–Ω–∫–æ–π "1" –æ—Ç—Ä–∞–∂–∞–µ—Ç –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–∏–∑–∫–æ–π –æ—Ü–µ–Ω–∫–µ.
- –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö —Ç–µ–∫—Å—Ç—ã –∫–∞–∑–∞–ª–∏—Å—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—Ç—Ä—ã–≤–æ—á–Ω—ã–º–∏ –∏–ª–∏ —Å—Ç—Ä–∞–Ω–Ω–æ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø–æ—Ç–µ—Ä—é —Å–º—ã—Å–ª–∞ –∏–ª–∏ –∫–∞–∂—É—â—É—é—Å—è –Ω–µ—Å–≤—è–∑–Ω–æ—Å—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π.

–ü–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç —É—Å–ø–µ—à–Ω–æ–µ –¥–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏. –•–æ—Ç—è –∏–º–µ—é—Ç—Å—è –∑–∞–º–µ—á–∞–Ω–∏—è –∫ –∫–∞—á–µ—Å—Ç–≤—É –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤, –≤ —Ü–µ–ª–æ–º, –º–æ–¥–µ–ª—å –ø–æ–∫–∞–∑–∞–ª–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω–æ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–∞–¥–∞–Ω–Ω–æ–π –æ—Ü–µ–Ω–∫–µ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É. –≠—Ç–æ—Ç —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–æ–æ–±—É—á–µ–Ω–Ω—ã—Ö —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞.

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ú—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —É–ø—Ä–æ—â—ë–Ω–Ω–æ –≤—ã–ø–æ–ª–Ω–∏–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ç–µ–∫—Å—Ç–∞, –≤—ã–±—Ä–∞–≤ —É–∂–µ –∏–º–µ—é—â–∏–µ—Å—è –Ω–∞–∑–≤–∞–Ω–∏—è –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞. –í –∫–∞—á–µ—Å—Ç–≤–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞ —Å—Ç–æ–∏—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ç–µ–∫—Å—Ç–∞ –¥–ª—è —Å–ª—É—á–∞–π–Ω–æ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π. –û–¥–Ω–∞–∫–æ, –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ—Å—Ç—å—é –¥–∞—Ç–∞—Å–µ—Ç–∞, –≤–∫–ª—é—á–∞—é—â–µ–≥–æ –≤—Å–µ–≥–æ 15,000 –∑–∞–ø–∏—Å–µ–π. –ú–∞–ª—ã–π —Ä–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞ –º–æ–∂–µ—Ç –Ω–µ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ –¥–ª—è —Ä–µ–¥–∫–∏—Ö –∏–ª–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π.

–î–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –≤–æ–∑–º–æ–∂–Ω–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, top_k –∏ top_p –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏. –¢–∞–∫–∂–µ, —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö) –º–æ–∂–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã. –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –æ–±—É—á–µ–Ω–∏—è –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–æ–≥—É—Ç –ø–æ–º–æ—á—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –Ω–∞–∏–ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ –≤ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á–∞—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞.

## –¶–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```latex
@misc{pisarenko2024fine-tuning,
  author = {Pisarenko, Anton},
  title = {Fine-tuning the {GPT-2} model for generating descriptions of establishments based on type and rating},
  year = {2024},
  howpublished = {\url{https://github.com/AntonSHBK/fine_tune_gpt_model}},
}
```

## –ö–æ–Ω—Ç–∞–∫—Ç—ã
* [Telegram](https://t.me/antonSHBK)